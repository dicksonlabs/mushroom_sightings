<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <%= auto_discovery_link_tag(:rss, {:controller => 'observer', :action  =>  'rss'}, {:title => :app_rss.l}) %>
  <title><%= :app_title.l %>: <%= if @title.nil? then controller.action_name else @title end %></title>
  <%=
    css = nil
    if CSS.member?(controller.action_name)
        css = controller.action_name
    else
        unless @user.nil?
            css = @user.theme
        end
    end
    unless CSS.member?(css)
        css = CSS[rand(CSS.length)]
    end
    stylesheet_link_tag 'general', css
  %>
  <%= "<link rel=\"SHORTCUT ICON\" href=\"#{DOMAIN}/images/favicon.ico\" />"%>
  <%= sort_javascript_includes.map {|m| javascript_include_tag(m)} %>
  <% if @header %>
    <%= @header %>
  <% end %>
</head>
<body>
<%= report_browser_status %>
    <div id="columns">
        <table cellpadding="0" cellspacing="0" border="0">
            <tr>
                <td valign="top" height="100%">
                    <table class="LeftSide" cellpadding="10">
                        <tr>
                            <td id="banner">
                                <%= @page_title || :app_banner.l %>
                            </td>
                        </tr>
                        <tr>
                            <td valign="top" align="left">
                                <%= link_to(lnbsp(:app_intro), :controller => 'observer',
                                            :action => 'intro') %><br/>
                                <%= link_to(lnbsp(:app_how_to_use),
                                            :controller => 'observer',
                                            :action => 'how_to_use') %><br/>
                                <%= link_to(lnbsp(:app_how_to_help),
                                            :controller => 'observer',
                                            :action => 'how_to_help') %><br/>
                                <%= link_to(lnbsp(:app_send_a_comment), :controller => 'observer',
                                            :action => 'ask_webmaster_question') %><br/>
                                <br/>

                                <%= link_to(lnbsp(:app_index_a_z), :controller => 'name',
                                                  :action => 'observation_index') %><br/>
                                <br/>
 
                                <%= lnbsp(:app_latest) %>:<br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_latest_changes),
                                                        :controller => 'observer',
                                                        :action => 'list_rss_logs') %><br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_newest_images), :controller => 'image',
                                                        :action => 'list_images') %><br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_comments), :controller => 'comment',
                                                        :action => 'list_comments') %><br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_news), :controller => 'observer',
                                                        :action => 'news') %><br/>
                                <br/>

                                <%= lnbsp(:app_observations_left) %>:<br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_create_observation),
                                                        :controller => 'observer',
                                                        :action => 'create_observation') %><br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_sort_by_date_obs),
                                                        :controller => 'observer',
                                                        :action => 'list_observations') %><br/>
                                <br/>

                                <%= lnbsp(:app_species_list) %>:<br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_create_list),
                                                        :controller => 'species_list',
                                                        :action => 'name_lister') %><br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_sort_by_date_spl),
                                                        :controller => 'species_list',
                                                        :action => 'list_species_lists') %><br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_sort_by_title),
                                                        :controller => 'species_list',
                                                        :action => 'species_lists_by_title') %><br/>
                                <br/>

                                <% if @user.nil? %>
                                <%= lnbsp(:app_account) %>:<br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_login), :controller => 'account',
                                                        :action => 'login') %><br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_create_account),
                                                        :controller => 'account',
                                                        :action => 'signup') %>
                                <% else %>
                                <%= lnbsp(:app_current_user) %>:<br/>
                                &nbsp;&nbsp;<%= h(@user.login) %><br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_comments_for_you),
                                                        :controller => 'comment',
                                                        :action => 'show_comments_for_user',
                                                        :id => @user.id) %><br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_your_observations),
                                                        :controller => 'observer',
                                                        :action => 'show_user_observations',
                                                        :id => @user.id) %><br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_your_summary),
                                                        :controller => 'observer',
                                                        :action => 'show_user',
                                                        :id => @user.id) %><br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_preferences),
                                                        :controller => 'account',
                                                        :action => 'prefs') %><br/>
                                &nbsp;&nbsp;<a href="http://lists.mushroomobserver.org/listinfo.cgi/general-mushroomobserver.org"><%= lnbsp(:app_join_mailing_list)%></a><br/>
                                &nbsp;&nbsp;<%= link_to(lnbsp(:app_logout),
                                                        :controller => 'account',
                                                        :action => 'logout_user') %>
                                    <% if @user.id == 0 %>
                                        <br/><br/>
                                        Admin:<br/>
                                        &nbsp;&nbsp;<%= link_to(lnbsp(:app_users),
                                                                :controller => 'observer',
                                                                :action => 'users_by_name') %><br/>
                                        &nbsp;&nbsp;<%= link_to(lnbsp(:app_email_all_users),
                                                                :controller => 'observer',
                                                                :action => 'email_features') %><br/>
                                        &nbsp;&nbsp;<%= link_to(lnbsp(:app_add_to_group),
                                                                :controller => 'account',
                                                                :action => 'add_user_to_group') %><br/>
                                    <% end %>
                                <% end %><br/>
                                <br/>

                                <%= link_to(lnbsp(:app_contributors), :controller => 'observer',
                                            :action => 'users_by_contribution') %><br/>
                                <%= link_to(lnbsp(:app_site_stats), :controller => 'observer',
                                            :action => 'show_site_stats') %><br/>
                                <br/>

                                <div id="color_note">
                                    <%= link_to(lnbsp(:app_colors_from) % css,
                                                :controller => 'observer', :action => 'color_themes') %><br/><br/>
                                    <%= lnbsp(:app_powered_by) %>:<br/>
                                    <a href='http://www.rubyonrails.org'>Ruby&nbsp;on&nbsp;Rails</a><br/>
                                    <%= lnbsp(:app_preferred_browser) %>:<br/>
                                    <a href='http://www.mozilla.com/firefox/'>FireFox</a>
                                    <% if @invalid.nil? %>
                                        <p>
                                            <a href="http://validator.w3.org/check?uri=referer"><img
                                                src="http://www.w3.org/Icons/valid-xhtml10"
                                                alt="Valid XHTML 1.0 Transitional" height="31" width="88" border="0"/></a>
                                        </p>
                                    <% end %>
                                </div>

                            </td>
                        </tr>
                    </table>
                </td>
                <td width="100%" valign="top" class="main">
                    <div style="padding:10px">
                        <%
                        pattern = session[:pattern]
                        form_tag(:controller => 'observer', :action => 'pattern_search') do %>
                          <%= :app_find.l %>: <%= text_field("search", "pattern", :size => 30, :value => pattern)%>
                          <%= submit_tag :app_observations_find.l %>
                          <%= submit_tag :app_images_find.l %>
                          <%= submit_tag :app_names_find.l %>
                          <%= submit_tag :app_locations_find.l %>
                          <% if @start %>
                              Start: <%= Time.now.to_f - @start.to_f %>
                              <% @start = nil %>
                          <% end %>
                        <% end %>
                        <% if flash[:notice] %>
                          <%= boxify(flash[:notice_level]) %>
                            <%= flash[:notice] %>
                          <%= end_boxify %>
                          <% flash_clear %>
                        <% end %>
                        <%= @content_for_layout %>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
    </script>
    <script type="text/javascript">
    _uacct = "UA-1916187-1";
    if (typeof urchinTracker != 'undefined') urchinTracker();
    </script>
</body>
</html>
