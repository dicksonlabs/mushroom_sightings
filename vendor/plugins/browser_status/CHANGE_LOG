Revision history:

20080723: Extracted it from my code to stand alone. -JPH
